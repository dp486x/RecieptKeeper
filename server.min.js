/*! receiptkeeper 2018-08-20 03:08:45 */

const express=require("express"),app=express(),path=require("path"),chalk=require("chalk"),morgan=require("morgan"),route=express.Router(),mongoose=require("mongoose");mongoose.Promise=require("bluebird");const bodyParser=require("body-parser"),port=3333;var fs=require("fs"),moment=require("moment"),util=require("util");const host="",storeFilesAtRoot="./receipts/";var hostname="localhost";mongoose.connect("mongodb://"+hostname+":27017/receipts").then(()=>{console.log("connected to mongoDB at "+hostname+":27017")},e=>{console.log("failed connection")}),app.use(express.static(__dirname+"/")),app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json()),app.use(morgan("dev",{skip:function(e,o){return o.statusCode<400},stream:process.stderr})),app.use(morgan("dev",{skip:(e,o)=>o.statusCode>=400,stream:process.stdout}));var requestTime=function(e,o,r){console.log(chalk.green("=================================================")),e.requestTime=moment().format(),console.log(util.inspect("got request")),r()};app.use(requestTime),app.use("/user",require("./app/controllers/user_controller")),app.use("/notify",require("./app/controllers/notifications_controller")),app.use("/receipt",require("./app/controllers/receipt_controller")),app.get("/",(e,o)=>{o.send("Welcome to the receipt Keeper.")}),app.listen(3333,()=>{console.log("Server started  at : "+chalk.blue(3333))});